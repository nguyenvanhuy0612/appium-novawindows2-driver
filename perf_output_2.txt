--- 02_page_source_screenshot.js (Enhanced) ---
Connecting to Appium at http://192.168.1.19:4723/
1. Finding button...
Time taken: 1543ms
   Button found: [object Object]
Connecting to Appium at http://192.168.1.19:4723/
2. Finding button2...
2026-01-15T16:46:45.643Z ERROR webdriver: WebDriverError: Cannot convert argument "collection", with value: "System.Windows.Automation.AutomationElementCollection", for "AddRange" to type 
"System.Collections.Generic.IEnumerable`1[System.Windows.Automation.AutomationElement]": "Cannot convert the 
"System.Windows.Automation.AutomationElementCollection" value of type "System.Windows.Automation.AutomationElementCollection" to type 
"System.Collections.Generic.IEnumerable`1[System.Windows.Automation.AutomationElement]"."
At line:1 char:293
+ ... ::Window)); if ($null -ne $validEl) { $els.AddRange($validEl); } } re ...
+                                           ~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [], MethodException
    + FullyQualifiedErrorId : MethodArgumentConversionInvalidCastArgument
 
 when running "element" with method "POST"
Time taken: 1821ms
Error: unknown error: WebDriverError: Cannot convert argument "collection", with value: "System.Windows.Automation.AutomationElementCollection", for "AddRange" to type 
"System.Collections.Generic.IEnumerable`1[System.Windows.Automation.AutomationElement]": "Cannot convert the 
"System.Windows.Automation.AutomationElementCollection" value of type "System.Windows.Automation.AutomationElementCollection" to type 
"System.Collections.Generic.IEnumerable`1[System.Windows.Automation.AutomationElement]"."
At line:1 char:293
+ ... ::Window)); if ($null -ne $validEl) { $els.AddRange($validEl); } } re ...
+                                           ~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [], MethodException
    + FullyQualifiedErrorId : MethodArgumentConversionInvalidCastArgument
 
 when running "element" with method "POST"
    at FetchRequest._request (file:///D:/SecureAge/appium-novawindows2-driver/node_modules/webdriver/build/node.js:1960:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Browser.wrapCommandFn (file:///D:/SecureAge/appium-novawindows2-driver/node_modules/@wdio/utils/build/index.js:982:23)
    at async Browser.$ (file:///D:/SecureAge/appium-novawindows2-driver/node_modules/webdriverio/build/node.js:1035:15)
    at async Browser.wrapCommandFn (file:///D:/SecureAge/appium-novawindows2-driver/node_modules/@wdio/utils/build/index.js:982:23)
    at async timeFunc (D:\SecureAge\appium-novawindows2-driver\examples\webdriverio\10_perf_check.js:11:28)
    at async main (D:\SecureAge\appium-novawindows2-driver\examples\webdriverio\10_perf_check.js:49:25) {
  url: URL {
    href: 'http://192.168.1.19:4723/session/df7e4102-ab60-4b7d-abde-2454911d5f8f/element',
    origin: 'http://192.168.1.19:4723',
    protocol: 'http:',
    username: '',
    password: '',
    host: '192.168.1.19:4723',
    hostname: '192.168.1.19',
    port: '4723',
    pathname: '/session/df7e4102-ab60-4b7d-abde-2454911d5f8f/element',
    search: '',
    searchParams: URLSearchParams {},
    hash: ''
  },
  opts: {
    method: 'POST',
    redirect: 'follow',
    signal: AbortSignal { aborted: false },
    body: '{"using":"xpath","value":"/Window/Pane[1]/Pane/Pane/Pane/Pane/ToolBar/Button[1]"}',
    headers: Headers {
      'Content-Type': 'application/json; charset=utf-8',
      Connection: 'keep-alive',
      Accept: 'application/json',
      'User-Agent': 'webdriver/9.22.0',
      'Content-Length': '81'
    },
    dispatcher: Agent {
      _events: [Object: null prototype] {},
      _eventsCount: 0,
      _maxListeners: undefined,
      [Symbol(shapeMode)]: false,
      [Symbol(kCapture)]: false,
      [Symbol(nodejs.stream.destroyed)]: false,
      [Symbol(onDestroyed)]: null,
      [Symbol(closed)]: false,
      [Symbol(onClosed)]: [],
      [Symbol(dispatch interceptors)]: [Array],
      [Symbol(options)]: [Object],
      [Symbol(maxRedirections)]: 0,
      [Symbol(factory)]: [Function: defaultFactory],
      [Symbol(clients)]: [Map],
      [Symbol(onDrain)]: [Function (anonymous)],
      [Symbol(onConnect)]: [Function (anonymous)],
      [Symbol(onDisconnect)]: [Function (anonymous)],
      [Symbol(onConnectionError)]: [Function (anonymous)],
      [Symbol(Intercepted Dispatch)]: [Function: Intercept]
    }
  }
}
